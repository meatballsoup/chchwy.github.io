<!DOCTYPE html>
<html>
<head>
    <base href="http://localhost:4000/">
    <title>  Objective-C學習筆記(1) 字串兩三事  - 調和的靈感 - Matt</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- load: css -->

    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/style.css" />

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="assets/ico/favicon.ico">
    <link rel="shortcut icon" href="assets/ico/favicon.png" type="image/png" />
    <link rel="icon" href="assets/ico/favicon.png" type="image/png" />

</head>

<body>

    <div class="container main">
        <div class="row">

            <!-- siedbar: open -->
            <div class="span3">
                <div class="siedbar">

    <div class="page-header small logo">
        <a href="#"><img src="assets/img/logo.png" width="115" height="41" /></a>
    </div>

    <ul class="nav nav-list">

<li class="nav-header"><a href="http://localhost:4000/">Home</a></li>
<li class="nav-header"><a href="http://localhost:4000/about.html">About me</a></li>
<!--<li class=""><a href="#">About me</a></li> -->
<li class="nav-header"><a href="archieve.html">Archieve<i class="icon-chevron-right"></i></a></li>

</ul>
</div>
            </div>
            <!-- siedbar: close -->

            <!-- content: open -->
            <div class="span9">

                <div class="main-content">
                <h2>調和的靈感 - Matt</h2>
                <hr/>

                <ul class="breadcrumb">
    <li>
        <a href="#">Home</a>
        <span class="divider">/</span>
        <a href="#">技術筆記</a>
    </li>
</ul>

<article>
    <h2 class="post-title">
        Objective-C學習筆記(1) 字串兩三事
    </h2>
    <div> 19 October 2012 </div>
    <hr/>

    <section class="post-body">
        <p>這是我學習Objective-C中記錄下來的筆記，有時會參雜一些自己的看法。</p>

<p>典型的C字串的型態是<code>const char[]</code>，比如說下面就是個C字串</p>

<pre><code>const char str[] = "This is a C string";
</code></pre>

<p>Objective-C雖然基於C語言，但是C字串實在太難用了，所以Objective-C有自己獨有的字串物件 - NSString。Foundation Framework也都以NSString為基礎。</p>

<p>只要字串常數的開頭冠上一個@符號，該字串就被編譯器視為<code>NSString*</code>型態，如:</p>

<pre><code>NSString* str = @"This is a Obj-c string";
</code></pre>

<p>NSString支持Unicode，內部採用UTF-16編碼儲存字串，由characterAtIndex:方法的回傳值可以察覺，
字串內的單個字元型態是unichar，而unichar又被定義為unsigned short (2 bytes)。</p>

<p>NSString是不可變物件(immutable object)，意思就是字串一旦創立之後就不能修改內容。
如果需要改動內容，就要建立一個新的字串。</p>

<p>比方你想把某個單詞第一個字母由小寫改成大寫，C字串大可直接修改<code>str[0] = 'B';</code>
但是NSString裡是找不到方法去直接修改原字串的，最簡便的辦法是呼叫capitalizedString方法來建立新字串，首字母大寫的新字串：</p>

<pre><code>NSString* str = @"bull";
NSString* str2 = [str capitalizedString];
</code></pre>

<ul>
<li><p>不可變字串有容易優化，線程安全，實作簡單強固等等優點，詳細請孤狗關鍵字Immutable Object。</p></li>
<li><p>如果需要頻繁改動字串的內容，請改用NSMutableString。NSString - NSMutableString 的關係就如同Java語言中String - StringBuilder 的關係，目的是將不可變字串與可變字串區分開來，專注於各自的任務上。</p></li>
</ul>


<h3>編碼</h3>

<p>NSString與其他編碼的字串雙向互轉很容易:</p>

<pre><code>char* asciiStr = "Hello, World!";
// 把ASCII字串轉為NSString
NSString* objcStr =[NSString stringWithCstring: asciiStr
                             encoding: NSASCIIStringEncoding];
// 再轉回ASCII字串
char* asciiStr2 = [NSString cStringUsingEncoding:NSASCIIStringEncoding];
</code></pre>

<p>UTF-8編碼因為太常用，所以有獨立的方法</p>

<pre><code>NSString*  str = [NSString* stringWithUTF8String:"許功蓋"];
char* utf8_str = [str UTF8String];
</code></pre>

<p>LLVM 4.0 添加了將C字串快速封裝為NSString的短語法</p>

<pre><code>const char cStr[] = "Hello world.";

//兩者效力相等。
NSString* myStr = @(cStr); //新語法
NSString* myStr = [NSString stringWithUTF8String:cStr); //舊語法
</code></pre>

<h3>String Format</h3>

<p>NSString沿用了printf()的那一套格式化字串(%d,%f,%s)，唯一額外添加的符號是<code>%@</code>，專用來打印NSString及NSObject。</p>

<pre><code>// 印NSString
NSLog("Hello, %@", @"David");

// 印NSArray
NSArray* myArray = @[@"Apple", @"Banana", @"Orange"];
NSLog("Array: %@", myArray);
</code></pre>

<p>使用<code>%@</code>符號來打印NSObject時，背地裡其實呼叫了description方法，所以複寫description方法就可以訂製輸出文字。像打印NSArray、NSDictionary時可以看見陣列與字典的內容，就是因為它們都自訂了輸出文字。</p>

<p>NSLog()也可以使用string format，如<code>NSLog(@"I'm %d years old", 5);</code>。</p>

<h3>讀寫檔案與URL</h3>

<p>NSString雖然只是個字串類別，但是自帶了很多可愛而方便的方法，像是懶人一行讀檔:</p>

<pre><code>NSString* content = [NSString stringWithContentsOfFile:@"data.txt"
                              encoding:NSUTF8StringEncoding
                              error:nil];
</code></pre>

<ul>
<li>當然，也有一行寫檔<code>writeToFile:atomically:encoding:error:</code>。</li>
<li>還有一行抓HTML網頁<code>stringWithContentsOfURL:encoding:error:</code>。</li>
</ul>


<!--
### 檔案路徑操作
參考來源:
- [各種Objective-C新列表及支援版本][1]
- [Objective-C字面常數][2]
[1]: http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/ObjCAvailabilityIndex/_index.html "Objective-C Feature Available."
[2]: http://clang.llvm.org/docs/ObjectiveCLiterals.html "Objective-C new literal"
-->




    </section>
</article>

<hr />

<hr />
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'chchwy'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>





                </div>
            </div>
            <!-- content: close -->

        </div>
    </div>

    <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-5266256-5");
      pageTracker._trackPageview();
    } catch(err) {}
</script>

    <!-- load: js libraries -->
    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/bootstrap.js"></script>

</body>

</html>